import{_ as I,C as w,m as N,l as k,B as X,G as j,b as g,r as B,o as i,c as p,a as l,F as C,i as $,n as f,t as S,s as P,h as d,p as M,f as V,u as D,g as E,q as F,w as b,d as y,X as G,H as L}from"./index-a5ee933b.js";import{G as z}from"./goods-item-bc8e42ea.js";const T=m=>(M("data-v-e83070ee"),m=m(),V(),m),q={key:0,class:"sub-filter"},U={class:"item"},H=T(()=>l("div",{class:"head"},"品牌：",-1)),R={class:"body"},A=["onClick"],J={class:"head"},K={class:"body"},O=["onClick"],Q={key:1,class:"sub-filter"},W={__name:"sub-filter",setup(m,{emit:v}){const e=w(),n=N({value:{}}),o=k(null),s=k(!1);X(()=>e.params.id,a=>{a&&`/category/sub/${a}`===e.path&&(s.value=!0,j(e.params.id).then(r=>{r.result.brands.selectedBrand=null,r.result.brands.unshift({id:null,name:"全部"}),r.result.saleProperties.forEach(c=>{c.selectedProp=null,c.properties.unshift({id:null,name:"全部"})}),o.value=r.result,n.value=r.result,s.value=!1}))},{immediate:!0}),g(o),console.log("sum",n),console.log("sum.value",n.value);const t=()=>{const a={brandId:null,attrs:[]};return a.brandId=o.value.selectedBrand,o.value.saleProperties.forEach(r=>{if(r.selectedProp){const c=r.properties.find(_=>_.id===r.selectedProp);a.attrs.push({groupName:r.name,propertyName:c.name})}}),a.attrs.length===0&&(a.attrs=null),a},h=a=>{o.value.selectedBrand!==a&&(o.value.selectedBrand=a)},u=(a,r)=>{a.selectedProp!==r&&(a.selectedProp=r,v("filter-change",t()))};return(a,r)=>{const c=B("XtxSkeleton");return o.value&&!s.value?(i(),p("div",q,[l("div",U,[H,l("div",R,[(i(!0),p(C,null,$(o.value.brands,_=>(i(),p("a",{onClick:x=>h(_.id),class:f({active:_.id===o.value.brands.selectedBrand}),href:"javascript:;",key:_.id},S(_.name),11,A))),128))])]),o.value.saleProperties?(i(!0),p(C,{key:0},$(o.value.saleProperties,_=>(i(),p("div",{class:"item",key:_.id},[l("div",J,S(_.name)+":",1),l("div",K,[(i(!0),p(C,null,$(_.properties,x=>(i(),p("a",{onClick:ce=>u(_,x.id),class:f({active:x.id===_.selectedProp}),href:"javascript:;",key:x.id},S(x.name),11,O))),128))])]))),128)):P("",!0)])):(i(),p("div",Q,[d(c,{class:"item",width:"800px",height:"40px"}),d(c,{class:"item",width:"800px",height:"40px"}),d(c,{class:"item",width:"600px",height:"40px"}),d(c,{class:"item",width:"600px",height:"40px"}),d(c,{class:"item",width:"600px",height:"40px"})]))}}},Y=I(W,[["__scopeId","data-v-e83070ee"]]),Z={__name:"sub-bread",setup(m){const v=D(),e=w(),n=E(()=>{const o={};return v.state.category.list.forEach(s=>{if(s.children){const t=s.children.find(h=>h.id===e.params.id);t&&(o.top={id:s.id,name:s.name},o.sub={id:t.id,name:t.name})}}),o});return(o,s)=>{const t=B("XtxBreadItem"),h=B("XtxBread");return i(),F(h,null,{default:b(()=>[d(t,{to:"/"},{default:b(()=>[y("首页")]),_:1}),g(n).top?(i(),F(t,{key:0,to:`/category/${g(n).top.id}`},{default:b(()=>[y("电器")]),_:1},8,["to"])):P("",!0),g(n).sub?(i(),F(t,{key:g(n).sub.id},{default:b(()=>[y(S(g(n).sub.name),1)]),_:1})):P("",!0)]),_:1})}}};const ee={class:"sub-sort"},se={class:"sort"},te={class:"check"},ae={__name:"sub-sort",setup(m,{emit:v}){const e=N({inventory:!1,onlyDiscount:!1,sortField:null,sortMethod:null}),n=s=>{if(s==="price")e.sortField=s,e.sortMethod===null?e.sortMethod="desc":e.sortMethod=e.sortMethod==="desc"?"asc":"desc";else{if(e.sortField=s)return;e.sortField=s,e.sortMethod=null}v("sort-change",e)},o=()=>{v("sort-change",e)};return(s,t)=>{const h=B("XtxCheckbox");return i(),p("div",ee,[l("div",se,[l("a",{class:f({active:e.sortField===null}),onClick:t[0]||(t[0]=u=>n(null)),href:"javascript:;"},"默认排序",2),l("a",{class:f({active:e.sortField==="publishTime"}),onClick:t[1]||(t[1]=u=>n("publishTime")),href:"javascript:;"},"最新商品",2),l("a",{class:f({active:e.sortField==="orderNum"}),onClick:t[2]||(t[2]=u=>n("orderNum")),href:"javascript:;"},"最高人气",2),l("a",{class:f({active:e.sortField==="evaluateNum"}),onClick:t[3]||(t[3]=u=>n("evaluateNum")),href:"javascript:;"},"评论最多",2),l("a",{onClick:t[4]||(t[4]=u=>n("price")),href:"javascript:;"},[y("价格排序 "),l("i",{class:f(["arrow up",{active:e.sortField=="price"&&e.sortMethod==="asc"}])},null,2),l("i",{class:f(["arrow down",{active:e.sortField=="price"&&e.sortMethod==="desc"}])},null,2)])]),l("div",te,[d(h,{onChange:o,modelValue:e.inventory,"onUpdate:modelValue":t[5]||(t[5]=u=>e.inventory=u)},{default:b(()=>[y("仅显示有货商品")]),_:1},8,["modelValue"]),d(h,{onChange:o,modelValue:e.onlyDiscount,"onUpdate:modelValue":t[6]||(t[6]=u=>e.onlyDiscount=u)},{default:b(()=>[y("仅显示特惠商品")]),_:1},8,["modelValue"])])])}}},oe=I(ae,[["__scopeId","data-v-2e40c662"]]);const ne={class:"sub-category"},le={class:"container"},re={class:"goods-list"},ie={__name:"sub",setup(m){const v=w(),e=k(!1),n=k(!1),o=k([]);let s={page:1,pageSize:20};const t=()=>{e.value=!0,s.categoryId=v.params.id,L(s).then(({result:a})=>{a.items.length?(o.value.push(...a.items),s.page++):n.value=!0,e.value=!1})};X(()=>v.params.id,a=>{a&&`/category/sub/${a}`===v.path&&(n.value=!1,o.value=[],s={page:1,pageSize:20})});const h=a=>{n.value=!1,s={...s,...a},s.page=1},u=a=>{n.value=!1,s={...s,...a},s.page=1,o.value=[]};return(a,r)=>(i(),p("div",ne,[l("div",le,[d(Z),d(Y,{onFilterChange:u}),l("div",re,[d(oe,{onSortChange:h}),l("ul",null,[(i(!0),p(C,null,$(o.value,c=>(i(),p("li",{key:c.id},[d(z,{goods:c},null,8,["goods"])]))),128))]),d(G,{loading:e.value,finished:n.value,onInfinite:t},null,8,["loading","finished"])])])]))}},_e=I(ie,[["__scopeId","data-v-afac743d"]]);export{_e as default};
